jobs:

job:

trigger:
- features-ms-CristianMendoza-mensaje

pool:
    vmImage: 'ubuntu-latest'
    
steps:
- script: |
      git fetch --unshallow
  displayName: 'convert to non-shallow clone' 

steps:

- task: Gradle@3
  inputs:
    gradleWrapperFile: 'gradlew'
    tasks: 'build'
    publishJUnitResults: true
    testResultsFiles: '**/TEST-*.xml'
    codeCoverageToolOption: 'JaCoCo'
    codeCoverageClassFilesDirectories: 'build/classes/main/'
    javaHomeOption: 'JDKVersion'
    sonarQubeRunAnalysis: false
    spotBugsAnalysis: false

job:

pool:
    'Default'
steps:
  - task: Kubernetes@1
    inputs:
      connectionType: 'None'
      command: 'create'
      arguments: 'deployment microservice --image=cristianmendoza/testing-web'
      secretType: 'dockerRegistry'
      containerRegistryType: 'Azure Container Registry'
inputs:
    script: 'kubectl port-forward deployment/testing-web 8080:8085'
    displayName: 'Redirecci√≥n de puerto'